<Window x:Class="JobsVssManager.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Jobs VSS Manager" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <ToolBar Grid.Row="0" Padding="5">
            <Button Content="Create Snapshot" Command="{Binding CreateSnapshotCommand}" 
                    IsEnabled="{Binding IsNotBusy}" Padding="10,5" Margin="5,0"/>
            <Button Content="Delete Snapshots" Command="{Binding DeleteSnapshotCommand}" 
                    IsEnabled="{Binding IsNotBusy}" Padding="10,5" Margin="5,0"/>
            <Separator/>
            <Button Content="Restore" Command="{Binding RestoreCommand}" 
                    IsEnabled="{Binding IsNotBusy}" Padding="10,5" Margin="5,0"/>
            <Button Content="Redo" Command="{Binding RedoCommand}" 
                    IsEnabled="{Binding IsNotBusy}" Padding="10,5" Margin="5,0"/>
        </ToolBar>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <!-- Jobs List -->
            <GroupBox Grid.Column="0" Header="Jobs" Margin="5">
                <ListBox ItemsSource="{Binding Jobs}" 
                         SelectedItem="{Binding SelectedJob}"
                         DisplayMemberPath="Name"
                         IsEnabled="{Binding IsNotBusy}"/>
            </GroupBox>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" 
                          Background="LightGray"/>

            <!-- Snapshots List -->
            <GroupBox Grid.Column="2" Header="Snapshots" Margin="5">
                <ListBox ItemsSource="{Binding Snapshots}" 
                         SelectedItem="{Binding SelectedSnapshot}"
                         IsEnabled="{Binding IsNotBusy}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Description}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding CreatedAt, StringFormat='Created: {0:yyyy-MM-dd HH:mm:ss}'}" 
                                           FontSize="10" Foreground="Gray"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </GroupBox>

            <!-- Busy Overlay -->
            <Grid Grid.ColumnSpan="3" Background="#80000000" 
                  Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar Width="200" Height="20" IsIndeterminate="True" Margin="10"/>
                    <TextBlock Text="{Binding StatusMessage}" Foreground="White" 
                               FontSize="14" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="{Binding IsBusy, StringFormat='Busy: {0}'}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
